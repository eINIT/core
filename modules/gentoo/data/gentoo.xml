<?xml version="1.0" encoding="UTF-8" ?>
<einit>
 <configuration>
  <compatibility>
   <sysv-distribution-gentoo>
<!-- in case you wish to use gentoo-ish init.d scripts, use this:
     NOTE: this should only be used with gentoo-ish init.d scripts, as they need special treatment -->
<!--      <init.d path="/etc/init.d/" /> -->
<!-- use this to make einit parse gentoo's runlevels as einit modes.
     NOTE: until someone defines a list with gentoo<>einit aliases, you'll
      get lots of unknown dependencies
     you also shouldn't set "exclusive" to true. just... don't do it, it'll
     override all the modes that are defined in the xml configuration with
     gentoo's runlevel data which means lots of important things will be
     missing - like mount/critical... -->
<!--      <runlevels path="/etc/runlevels" exclusive="false" /> -->
      <parse-env.d b="true" />
      <service-tracker b="true" path="/var/lib/init.d" />

<!-- scriptlets to process gentoo's init.d scripts
     ( i don't particularly feel like re-implementing a complete sh right now )
     arguments: script-path, script-name, action -->
      <init.d-scriptlets
       list-dependencies='
        need () { echo "need="$@; };
        use () { echo "use="$@; };
        provide () { echo "provide="$@; };
        before () { echo "before="$@; };
        after () { echo "after="$@; };
        depend () { echo "need=mount/local"; };

        if test -e /etc/conf.d/${script-name}; then source /etc/conf.d/${script-name}; fi;
        source ${script-path};

        depend;'
       execute='
        ewarn () { echo "feedback|warning|"$@; };
        eerror () { echo "feedback|warning|"$@; };
        ebegin () { echo "feedback|notice|"$@; };
        einfo () { echo "feedback|notice|"$@; };
        eend () {
         if test $1 = 0; then
          echo "feedback|success|$2";
         else
          echo "feedback|failure|$2";
         fi; };
        if test -e /etc/conf.d/${script-name}; then source /etc/conf.d/${script-name}; fi;
        source ${script-path};
        ${action};' />
    </sysv-distribution-gentoo>
  </compatibility>

  <secondary>
<!-- sh-imports for gentoo systems -->

   <if file-exists="/etc/gentoo-release">
    <file-sh id="/etc/conf.d/hostname" configuration-network-hostname="HOSTNAME:s" />
    <file-sh id="/etc/conf.d/keymaps" configuration-peripherals-keyboard="KEYMAP:layout" />
<!-- this does not (yet) work as expected:
    <file-sh id="/etc/conf.d/clock" configuration-program-options-hwclock="CLOCK:s" /> -->
   </if>
  </secondary>

 </configuration>
</einit>
