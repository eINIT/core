<einit prefix="services-virtual-network">
 <ifctl id="wpa_supplicant"
  enable="pexec-options no-pipe;
   echo &quot;Using 'wpa_supplicant' to manage interface.&quot;;
   sleep 3;
   wpa_supplicant -D ${configuration_network_interfaces_${interface}_driver} -i ${interface} -c ${configuration_network_interfaces_${interface}_config} -w -B;
   wpa_cli -i ${interface} -B; status=$(wpa_cli status | grep wpa_state | sed -e 's/.*wpa_state=//');
   while [[ $status != COMPLETED ]];
    do sleep .1; status=$(wpa_cli status | grep wpa_state | sed -e 's/.*wpa_state=//');
   done; /bin/true"
  disable="echo &quot;Disabling 'wpa_supplicant'.&quot;;
   wpa_cli terminate"
  variables="configuration-network-interfaces-${interface}/.*" />
</einit>
