<einit prefix="services-virtual-network">
 <ifctl id="wpa_supplicant"
  requires="kern-${interface}"
  enable="i=0; wpa_supplicant -D ${configuration_network_interfaces_${interface}_driver} -i ${interface} -c ${configuration_network_interfaces_${interface}_config} &amp;&gt;/dev/null &amp;
   while [ &quot;$(wpa_cli status | egrep wpa_state | sed 's/wpa_state=//')&quot; != &quot;COMPLETED&quot; ]; do
    if [ '${i}' == '0' ]; then
     echo -n 'waiting for interface...'; i=1;
    fi; sleep .5; 
   done"
  disable="wpa_cli -p /var/run/wpa_supplicant -i ${interface} terminate"
  variables="configuration-network-interfaces-${interface}/.*" />
</einit>